<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project SYSTEM "ant.dtd">

<project name="jamal" default="pack" basedir=".">
    
    <!-- SETUP -->

    <property name="SRC_DIR" value="../src" />
    <property name="DIST_DIR" value="../dist" />
    <property name="BUILD_DIR" value="build" />

    <property name="JS_COMPRESSOR" value="${BUILD_DIR}/js.jar" />
    
    <!-- MAIN -->
    <target name="folders" description="">
        <delete dir="${DIST_DIR}" quiet="true" />
        <mkdir dir="${DIST_DIR}" />
        <mkdir dir="${DIST_DIR}/controllers" />
        <mkdir dir="${DIST_DIR}/models" />
        <mkdir dir="${DIST_DIR}/views" />
        <mkdir dir="${DIST_DIR}/plugins" />
        <copy file="${SRC_DIR}/startup.js" tofile="${DIST_DIR}/startup.js"/>
    </target>
    
    <target name="pack" depends="folders" description="">
        <echo message="Packing application..." />
        <concat destfile="${DIST_DIR}/jamal.js">
            <fileset dir="${SRC_DIR}" includes="jamal.js" />
            <fileset dir="${SRC_DIR}" includes="plugins/*.js" />
        </concat>
        <java jar="${JS_COMPRESSOR}" fork="true">
            <arg value="${BUILD_DIR}/pack.js" />
            <arg value="${DIST_DIR}/jamal.js" />
            <arg value="${DIST_DIR}/jamal_packed.js" />
        </java>
        <echo message="You now have a jamal application in ${DIST_DIR}." />
        <echo message="There is a readable version and a packed one." />
        <echo message="Don't forget to add jQuery!" />
        <echo message="Done!" />
    </target>

</project>

